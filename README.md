# Discord 転送VCボット

転送用のボイスチャンネル（ロビー）に入室すると、自動的に新しいVCを作り、ロビー在室メンバー全員をそこへ移動します。生成VCは全員が抜けると自動削除されます。

## 使い方（権限）
- スラッシュコマンド: `/create-transfer`
  - `name`: 作成する「転送用VC（ロビー）」のチャンネル名
  - `limit`: 自動生成VCの最大参加人数（0で無制限）
- コマンドを実行できるのは **ユーザーID `716667546241335328`** または **ロールID `1419701562460344362`** を持つメンバーのみ。

## 必要なBot権限
- `チャンネルの管理 (MANAGE_CHANNELS)`
- `メンバーを移動 (MOVE_MEMBERS)`
- 推奨: `接続/発言/閲覧` など通常VC関連

## 環境変数（Railway Variables）
- `DISCORD_TOKEN` : ボットトークン
- `APPLICATION_ID` : アプリケーションID
- `GUILD_ID` : 対象サーバID（コマンドをそのギルドに登録）

## デプロイ手順（Railway）
1. このリポジトリを Railway に新規プロジェクトとしてデプロイ。
2. **Variables** に `DISCORD_TOKEN`, `APPLICATION_ID`, `GUILD_ID` を追加。
3. デプロイ後の起動ログに `[ready]` が出たらOK。初回起動時にスラッシュコマンドも自動登録されます。
   - もし反映に数分かかる場合はギルドコマンドは通常即時〜数十秒です。

## 動作仕様
- 転送VCに誰かが入室 → その瞬間の在室メンバー全員を対象に、新規VCを作成して一括移動します。
- 生成VCの名前は `＜ロビー名＞-001`, `-002` ... と連番で作られます。
- 生成VCが空になって 1.5 秒後に自動削除されます（レース条件回避のための微待機あり）。
- 作成した転送VCの設定は `transfer_channels.json` に保存され、再起動後も有効です。

## ローカル実行
```bash
cp .env.sample .env
# .env を編集
npm i
npm run start
# うまくコマンドが出ない場合は
node src/index.js --register
```
